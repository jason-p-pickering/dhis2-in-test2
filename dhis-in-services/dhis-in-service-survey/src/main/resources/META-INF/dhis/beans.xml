<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">
  
<!-- Store definitions -->

  <bean id="org.hisp.dhis.survey.SurveyStore"
    class="org.hisp.dhis.survey.hibernate.HibernateSurveyStore">
    <property name="sessionManager"
      ref="org.hisp.dhis.hibernate.HibernateSessionManager"/>
    
  </bean>
  <bean id="org.hisp.dhis.surveydatavalue.SurveyDataValueStore"
    class="org.hisp.dhis.surveydatavalue.hibernate.HibernateSurveyDataValueStore">
    <property name="sessionManager"
      ref="org.hisp.dhis.hibernate.HibernateSessionManager"/>
    
  </bean>
	  
<!-- Service definitions -->

  <bean id="org.hisp.dhis.survey.SurveyService"
    class="org.hisp.dhis.survey.DefaultSurveyService">
    <property name="surveyStore"
      ref="org.hisp.dhis.survey.SurveyStore"/>
  </bean>
  
  <bean id="org.hisp.dhis.surveydatavalue.SurveyDataValueService"
    class="org.hisp.dhis.surveydatavalue.DefaultSurveyDataValueService">
    <property name="surveyDataValueStore"
      ref="org.hisp.dhis.surveydatavalue.SurveyDataValueStore"/>
  </bean>
 
<!-- AOP transaction definitions -->
	
  <bean class="org.springframework.aop.support.RegexpMethodPointcutAdvisor">
    <property name="advice" ref="readOnlyTransactionInterceptor"/>
    <property name="patterns">
      <list>
        <value>.*\.SurveyStore\.get.*</value>
        <value>.*\.SurveyDataValueStore\.get.*</value>
		<value>.*\.DeTargetMappingStore\.get.*</value>
      </list>
    </property>
  </bean>

  <bean class="org.springframework.aop.support.RegexpMethodPointcutAdvisor">
    <property name="advice" ref="readWriteTransactionInterceptor"/>
    <property name="patterns">
      <list>
        <value>.*\.SurveyStore\.add.*</value>
        <value>.*\.SurveyStore\.update.*</value>
        <value>.*\.SurveyStore\.delete.*</value>
        <value>.*\.SurveyStore\.remove.*</value>
        <value>.*\.SurveyDataValueStore\.add.*</value>
        <value>.*\.SurveyDataValueStore\.update.*</value>
        <value>.*\.SurveyDataValueStore\.delete.*</value>
        <value>.*\.SurveyDataValueStore\.remove.*</value>
		<value>.*\.DeTargetMappingStore\.add.*</value>
        <value>.*\.DeTargetMappingStore\.update.*</value>
        <value>.*\.DeTargetMappingStore\.delete.*</value>
        <value>.*\.DeTargetMappingStore\.remove.*</value>
      </list>
    </property>
  </bean>	
	
  
<!-- Deletion AOP definitions -->
  
  <bean class="org.springframework.aop.support.RegexpMethodPointcutAdvisor">
    <property name="advice" ref="deletionInterceptor"/>
    <property name="patterns">
      <list>
        <value>.*\.SurveyService\.delete.*</value>
        <value>.*\.SurveyService\.remove.*</value>
        <value>.*\.SurveyDataValueService\.delete.*</value>
        <value>.*\.SurveyDataValueService\.remove.*</value>
		<value>.*\.DeTargetMappingService\.delete.*</value>
        <value>.*\.DeTargetMappingService\.remove.*</value>
      </list>
    </property>
  </bean>
	
	
	<!-- Service And Store definitions -->

  <bean id="org.hisp.dhis.target.DeTargetMappingService"
    class="org.hisp.dhis.target.DefaultDeTargetMappingService">
    <property name="deTargetMappingStore"
      ref="org.hisp.dhis.target.DeTargetMappingStore"/>
  </bean>
	
	<bean id="org.hisp.dhis.target.DeTargetMappingStore"
    class="org.hisp.dhis.target.HibernateDeTargetMappingStore">
    <property name="sessionManager"
      ref="org.hisp.dhis.hibernate.HibernateSessionManager"/>
    
  </bean>
  
    
</beans>
